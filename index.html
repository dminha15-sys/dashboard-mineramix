<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TRANSPORTE MIN√âRIO - CRISTHIAN - SIMPLES</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: Arial, sans-serif;
            background: #f5f5f5;
            padding: 20px;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        header {
            background: linear-gradient(135deg, #000 0%, #333 100%);
            color: white;
            padding: 30px;
            border-radius: 10px;
            margin-bottom: 30px;
            text-align: center;
        }
        h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        /* T√≠tulo MINERAMIX */
        .titulo-mineramix {
            color: white;      /* MINERA em branco */
            font-weight: bold;
        }
        .titulo-mineramix span {
            color: #FF6B35;    /* MIX em laranja */
        }

        .status {
            background: white;
            padding: 10px 20px;
            border-radius: 50px;
            display: inline-block;
            margin-top: 10px;
            font-weight: bold;
        }
        .status.online { color: #28a745; }
        .status.offline { color: #dc3545; }

        .cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        .card {
            background: white;
            padding: 25px;
            border-radius: 10px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
            border-left: 5px solid #FF6B35;
        }
        .card h3 {
            color: #333;
            margin-bottom: 15px;
            font-size: 1.2rem;
        }
        .valor {
            font-size: 2.5rem;
            font-weight: bold;
            color: #000;
            margin-bottom: 10px;
        }
        .loading {
            color: #666;
            font-style: italic;
        }
        button {
            background: #FF6B35;
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            margin: 10px 5px;
            transition: background 0.3s;
        }
        button:hover { background: #e55a2b; }
        button:disabled { background: #ccc; cursor: not-allowed; }

        .alert {
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
            border-left: 4px solid;
        }
        .alert.success {
            background: #d4edda;
            border-color: #28a745;
            color: #155724;
        }
        .alert.error {
            background: #f8d7da;
            border-color: #dc3545;
            color: #721c24;
        }
        .alert.info {
            background: #d1ecf1;
            border-color: #17a2b8;
            color: #0c5460;
        }

        table {
            width: 100%;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
            margin-top: 20px;
        }
        th {
            background: #333;
            color: white;
            padding: 15px;
            text-align: left;
        }
        td {
            padding: 15px;
            border-bottom: 1px solid #eee;
        }
        tr:hover { background: #f9f9f9; }

        /* Responsividade celular */
        @media (max-width: 600px) {
            body { padding: 10px; font-size: 14px; }
            header { padding: 20px 15px; }
            h1 { font-size: 1.6rem; word-wrap: break-word; }

            .cards {
                grid-template-columns: 1fr;
                gap: 15px;
            }
            .card { padding: 15px; font-size: 0.9rem; }
            .valor { font-size: 1.8rem; }
            button {
                width: 100%;
                padding: 12px 0;
                font-size: 1.1rem;
                margin: 8px 0;
            }

            table, thead, tbody, th, td, tr { display: block; }
            thead tr { display: none; }
            tbody tr {
                margin-bottom: 15px;
                border: 1px solid #ccc;
                border-radius: 8px;
                padding: 10px;
                background: white;
            }
            tbody td {
                padding-left: 50%;
                position: relative;
                text-align: left;
                border: none;
                border-bottom: 1px solid #eee;
            }
            tbody td::before {
                position: absolute;
                left: 15px;
                width: 45%;
                white-space: nowrap;
                font-weight: bold;
                content: attr(data-label);
                text-align: left;
                color: #333;
            }
            #tabelaContainer { overflow-x: auto; }
        }

    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Dashboard <span class="titulo-mineramix">MINERA<span>MIX</span></span></h1>
            <p>Controle de Log√≠stica em Transporte Min√©rio</p>
            <div class="status offline" id="status">üî¥ OFFLINE</div>
        </header>

        <div id="alert"></div>

        <div style="text-align: center; margin: 20px 0;">
            <button onclick="carregarDados()" id="btnCarregar">üì• Carregar Dados</button>
            <button onclick="testarConexao()" id="btnTestar">üîó Testar Conex√£o</button>
        </div>

        <div class="cards">
            <div class="card">
                <h3>Status do Sistema</h3>
                <div class="valor" id="statusSistema">Carregando...</div>
                <p id="detalhesStatus">Verificando conex√£o com servidor</p>
            </div>
            
            <div class="card">
                <h3>Total de Viagens</h3>
                <div class="valor" id="totalViagens">--</div>
                <p>Registros encontrados</p>
            </div>
            
            <div class="card">
                <h3>√öltima Atualiza√ß√£o</h3>
                <div class="valor" id="ultimaAtualizacao">--:--</div>
                <p id="fonteDados">Fonte: Google Sheets</p>
            </div>
        </div>

        <div id="tabelaContainer" style="display: none;">
            <h2 style="margin: 30px 0 15px 0;">Dados da Planilha</h2>
            <div id="tabelaDados"></div>
        </div>

        <footer style="text-align: center; margin-top: 50px; color: #666; font-size: 0.9rem;">
            <p>Dashboard Mineramix ‚Ä¢ Hospedado no Render.com</p>
            <p id="infoConexao">Conectando ao servidor...</p>
        </footer>
    </div>

    <script>
        const CONFIG = {
            API_URL: 'https://dashboard-mineramix-backend.onrender.com/api/dados',
            TEST_URL: 'https://dashboard-mineramix-backend.onrender.com/api/teste'
        };

        const elementos = {
            status: document.getElementById('status'),
            alert: document.getElementById('alert'),
            statusSistema: document.getElementById('statusSistema'),
            detalhesStatus: document.getElementById('detalhesStatus'),
            totalViagens: document.getElementById('totalViagens'),
            ultimaAtualizacao: document.getElementById('ultimaAtualizacao'),
            fonteDados: document.getElementById('fonteDados'),
            tabelaContainer: document.getElementById('tabelaContainer'),
            tabelaDados: document.getElementById('tabelaDados'),
            infoConexao: document.getElementById('infoConexao'),
            btnCarregar: document.getElementById('btnCarregar')
        };

        function mostrarMensagem(texto, tipo = 'info') {
            elementos.alert.innerHTML = `<div class="alert ${tipo}">${texto}</div>`;
            if (tipo !== 'error') setTimeout(() => elementos.alert.innerHTML = '', 5000);
        }

        async function testarConexao() {
            try {
                mostrarMensagem('üîç Testando conex√£o com o servidor...', 'info');
                const resposta = await fetch(CONFIG.TEST_URL);
                const dados = await resposta.json();
                elementos.statusSistema.textContent = '‚úÖ ONLINE';
                elementos.detalhesStatus.textContent = 'Servidor respondendo normalmente';
                elementos.status.className = 'status online';
                elementos.status.textContent = 'üü¢ ONLINE';
                mostrarMensagem(`‚úÖ Conex√£o bem-sucedida! ${dados.mensagem}`, 'success');
            } catch (erro) {
                elementos.statusSistema.textContent = '‚ùå OFFLINE';
                elementos.detalhesStatus.textContent = 'N√£o foi poss√≠vel conectar ao servidor';
                elementos.status.className = 'status offline';
                elementos.status.textContent = 'üî¥ OFFLINE';
                mostrarMensagem(`‚ùå Erro de conex√£o: ${erro.message}`, 'error');
            }
        }

        async function carregarDados() {
            try {
                elementos.btnCarregar.disabled = true;
                elementos.btnCarregar.textContent = '‚è≥ Carregando...';
                mostrarMensagem('üìä Buscando dados do Google Sheets...', 'info');
                const resposta = await fetch(CONFIG.API_URL);
                const dados = await resposta.json();
                if (dados.status === 'erro') throw new Error(dados.mensagem);

                elementos.totalViagens.textContent = dados.totalLinhas || 0;
                elementos.ultimaAtualizacao.textContent = new Date().toLocaleTimeString('pt-BR');
                elementos.fonteDados.textContent = `Fonte: Google Sheets (${dados.totalLinhas} registros)`;
                mostrarTabela(dados.dados);
                elementos.tabelaContainer.style.display = 'block';
                mostrarMensagem(`‚úÖ ${dados.mensagem} | ${dados.totalLinhas} registros carregados`, 'success');
                elementos.infoConexao.textContent = `√öltima atualiza√ß√£o: ${new Date().toLocaleString('pt-BR')}`;
            } catch (erro) {
                mostrarMensagem(`‚ùå Falha ao carregar dados: ${erro.message}`, 'error');
                mostrarDadosExemplo();
            } finally {
                elementos.btnCarregar.disabled = false;
                elementos.btnCarregar.textContent = 'üì• Carregar Dados';
            }
        }

        function mostrarTabela(dados) {
            if (!dados || dados.length === 0) {
                elementos.tabelaDados.innerHTML = '<p style="text-align: center; padding: 20px;">Nenhum dado encontrado</p>';
                return;
            }
            const cabecalhos = dados[0];
            const linhas = dados.slice(1, 11);
            let tabelaHTML = `<table><thead><tr>${cabecalhos.map(h => `<th>${h}</th>`).join('')}</tr></thead><tbody>`;
            linhas.forEach(linha => {
                tabelaHTML += `<tr>${linha.map((celula, i) => `<td data-label="${cabecalhos[i]}">${celula || ''}</td>`).join('')}</tr>`;
            });
            tabelaHTML += `</tbody></table><p style="text-align: center; margin-top: 10px; color: #666;">Mostrando ${linhas.length} de ${dados.length - 1} registros</p>`;
            elementos.tabelaDados.innerHTML = tabelaHTML;
        }

        function mostrarDadosExemplo() {
            elementos.totalViagens.textContent = '115';
            elementos.ultimaAtualizacao.textContent = new Date().toLocaleTimeString('pt-BR');
            elementos.fonteDados.textContent = 'Fonte: Dados de exemplo (modo offline)';
            const dadosExemplo = [
                ['DATA','CLIENTE','MOTORISTA','PLACA','DESTINO','KM','VALOR'],
                ['01/12/2025','POLIMIX','VALDECI','LLJ1600','S√£o Pedro da Aldeia, RJ','75','R$ 616,00'],
                ['01/12/2025','CIMENT RIO','EDUARDO','KZB6391','Araruama, RJ','102','R$ 1.060,00'],
                ['01/12/2025','CONCREVIT','ALEXANDRE','KNZ3136','Rio de Janeiro, RJ','340','R$ 2.175,00']
            ];
            mostrarTabela(dadosExemplo);
            elementos.tabelaContainer.style.display = 'block';
            mostrarMensagem('‚ö†Ô∏è Usando dados de exemplo (modo offline)', 'info');
        }

        window.addEventListener('load', () => setTimeout(testarConexao, 1000));
    </script>
</body>
</html>

